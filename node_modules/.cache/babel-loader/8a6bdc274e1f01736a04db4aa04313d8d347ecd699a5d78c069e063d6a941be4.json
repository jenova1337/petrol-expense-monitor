{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Mileage=()=>{const[log,setLog]=useState(null);useEffect(()=>{const reserveRaw=JSON.parse(localStorage.getItem(\"reserveLogs\"))||[];const petrolRaw=JSON.parse(localStorage.getItem(\"petrolLogs\"))||[];// Safely convert strings to numbers and parse dates\nconst reserves=reserveRaw.filter(r=>r.km&&!isNaN(r.km)).map(r=>({...r,type:\"reserve\",date:new Date(r.date),km:Number(r.km)// important!\n}));const petrols=petrolRaw.filter(p=>p.km&&p.litres&&!isNaN(p.km)&&!isNaN(p.litres)).map(p=>({...p,type:\"petrol\",date:new Date(p.date),litres:Number(p.litres),km:Number(p.km)}));// Merge and sort by date\nconst combined=[...reserves,...petrols].sort((a,b)=>a.date-b.date);// Look for latest valid R â†’ P â†’ R pattern\nfor(let i=combined.length-3;i>=0;i--){const a=combined[i];const b=combined[i+1];const c=combined[i+2];if(a.type===\"reserve\"&&b.type===\"petrol\"&&c.type===\"reserve\"){const distance=c.km-a.km;const mileage=b.litres>0?(distance/b.litres).toFixed(2):\"N/A\";setLog({beforeReserveKm:a.km,petrolLitres:b.litres,afterReserveKm:c.km,mileage});return;}}setLog(null);// No valid match found\n},[]);return/*#__PURE__*/_jsxs(\"div\",{style:{padding:20},children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\uD83D\\uDCCA Mileage Report\"}),log?/*#__PURE__*/_jsxs(\"table\",{border:\"1\",cellPadding:\"6\",style:{borderCollapse:\"collapse\"},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"S.No\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Before Petrol Reserved KM\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Petrol Poured (Litres)\"}),/*#__PURE__*/_jsx(\"th\",{children:\"After Petrol Reserved KM\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Mileage (km/l)\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"1\"}),/*#__PURE__*/_jsx(\"td\",{children:log.beforeReserveKm}),/*#__PURE__*/_jsx(\"td\",{children:log.petrolLitres}),/*#__PURE__*/_jsx(\"td\",{children:log.afterReserveKm}),/*#__PURE__*/_jsx(\"td\",{children:log.mileage})]})})]}):/*#__PURE__*/_jsx(\"p\",{children:\"\\uD83D\\uDCED No valid Reserve \\u2192 Petrol \\u2192 Reserve sequence found.\"})]});};export default Mileage;","map":{"version":3,"names":["React","useEffect","useState","jsx","_jsx","jsxs","_jsxs","Mileage","log","setLog","reserveRaw","JSON","parse","localStorage","getItem","petrolRaw","reserves","filter","r","km","isNaN","map","type","date","Date","Number","petrols","p","litres","combined","sort","a","b","i","length","c","distance","mileage","toFixed","beforeReserveKm","petrolLitres","afterReserveKm","style","padding","children","border","cellPadding","borderCollapse"],"sources":["/data/data/com.termux/files/home/petrol-expense-monitor-full/src/components/Mileage.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\n\nconst Mileage = () => {\n  const [log, setLog] = useState(null);\n\n  useEffect(() => {\n    const reserveRaw = JSON.parse(localStorage.getItem(\"reserveLogs\")) || [];\n    const petrolRaw = JSON.parse(localStorage.getItem(\"petrolLogs\")) || [];\n\n    // Safely convert strings to numbers and parse dates\n    const reserves = reserveRaw\n      .filter(r => r.km && !isNaN(r.km))\n      .map(r => ({\n        ...r,\n        type: \"reserve\",\n        date: new Date(r.date),\n        km: Number(r.km), // important!\n      }));\n\n    const petrols = petrolRaw\n      .filter(p => p.km && p.litres && !isNaN(p.km) && !isNaN(p.litres))\n      .map(p => ({\n        ...p,\n        type: \"petrol\",\n        date: new Date(p.date),\n        litres: Number(p.litres),\n        km: Number(p.km),\n      }));\n\n    // Merge and sort by date\n    const combined = [...reserves, ...petrols].sort((a, b) => a.date - b.date);\n\n    // Look for latest valid R â†’ P â†’ R pattern\n    for (let i = combined.length - 3; i >= 0; i--) {\n      const a = combined[i];\n      const b = combined[i + 1];\n      const c = combined[i + 2];\n\n      if (a.type === \"reserve\" && b.type === \"petrol\" && c.type === \"reserve\") {\n        const distance = c.km - a.km;\n        const mileage = b.litres > 0 ? (distance / b.litres).toFixed(2) : \"N/A\";\n\n        setLog({\n          beforeReserveKm: a.km,\n          petrolLitres: b.litres,\n          afterReserveKm: c.km,\n          mileage,\n        });\n        return;\n      }\n    }\n\n    setLog(null); // No valid match found\n  }, []);\n\n  return (\n    <div style={{ padding: 20 }}>\n      <h3>ðŸ“Š Mileage Report</h3>\n      {log ? (\n        <table border=\"1\" cellPadding=\"6\" style={{ borderCollapse: \"collapse\" }}>\n          <thead>\n            <tr>\n              <th>S.No</th>\n              <th>Before Petrol Reserved KM</th>\n              <th>Petrol Poured (Litres)</th>\n              <th>After Petrol Reserved KM</th>\n              <th>Mileage (km/l)</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr>\n              <td>1</td>\n              <td>{log.beforeReserveKm}</td>\n              <td>{log.petrolLitres}</td>\n              <td>{log.afterReserveKm}</td>\n              <td>{log.mileage}</td>\n            </tr>\n          </tbody>\n        </table>\n      ) : (\n        <p>ðŸ“­ No valid Reserve â†’ Petrol â†’ Reserve sequence found.</p>\n      )}\n    </div>\n  );\n};\n\nexport default Mileage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}