{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Mileage=()=>{const[log,setLog]=useState(null);// Store only the latest valid log\nuseEffect(()=>{const reserves=JSON.parse(localStorage.getItem(\"reserveLogs\"))||[];const petrols=JSON.parse(localStorage.getItem(\"petrolLogs\"))||[];// Convert all date strings to real Date objects and tag type\nconst taggedReserves=reserves.map(r=>({...r,type:\"reserve\",dateObj:new Date(r.date),km:parseFloat(r.km)}));const taggedPetrols=petrols.map(p=>({...p,type:\"petrol\",dateObj:new Date(p.date),litres:parseFloat(p.litres),km:parseFloat(p.km)}));const allLogs=[...taggedReserves,...taggedPetrols].sort((a,b)=>a.dateObj-b.dateObj);let latest=null;for(let i=0;i<allLogs.length-2;i++){const first=allLogs[i];const second=allLogs[i+1];const third=allLogs[i+2];if(first.type===\"reserve\"&&second.type===\"petrol\"&&third.type===\"reserve\"){const distance=third.km-first.km;const mileage=second.litres&&distance>0?(distance/second.litres).toFixed(2):\"N/A\";latest={beforeReserveKm:first.km,petrolLitres:second.litres,afterReserveKm:third.km,mileage};}}setLog(latest);},[]);return/*#__PURE__*/_jsxs(\"div\",{style:{padding:20},children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\uD83D\\uDCCA Mileage Report\"}),log?/*#__PURE__*/_jsxs(\"table\",{border:\"1\",cellPadding:\"6\",style:{borderCollapse:\"collapse\"},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"S.No\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Before Petrol Reserved KM\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Petrol Poured (Litres)\"}),/*#__PURE__*/_jsx(\"th\",{children:\"After Petrol Reserved KM\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Mileage (km/l)\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"1\"}),/*#__PURE__*/_jsx(\"td\",{children:log.beforeReserveKm}),/*#__PURE__*/_jsx(\"td\",{children:log.petrolLitres}),/*#__PURE__*/_jsx(\"td\",{children:log.afterReserveKm}),/*#__PURE__*/_jsx(\"td\",{children:log.mileage})]})})]}):/*#__PURE__*/_jsx(\"p\",{children:\"No valid Reserve \\u2192 Petrol \\u2192 Reserve sequence found.\"})]});};export default Mileage;","map":{"version":3,"names":["React","useEffect","useState","jsx","_jsx","jsxs","_jsxs","Mileage","log","setLog","reserves","JSON","parse","localStorage","getItem","petrols","taggedReserves","map","r","type","dateObj","Date","date","km","parseFloat","taggedPetrols","p","litres","allLogs","sort","a","b","latest","i","length","first","second","third","distance","mileage","toFixed","beforeReserveKm","petrolLitres","afterReserveKm","style","padding","children","border","cellPadding","borderCollapse"],"sources":["/data/data/com.termux/files/home/petrol-expense-monitor-full/src/components/Mileage.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\n\nconst Mileage = () => {\n  const [log, setLog] = useState(null); // Store only the latest valid log\n\n  useEffect(() => {\n    const reserves = JSON.parse(localStorage.getItem(\"reserveLogs\")) || [];\n    const petrols = JSON.parse(localStorage.getItem(\"petrolLogs\")) || [];\n\n    // Convert all date strings to real Date objects and tag type\n    const taggedReserves = reserves.map(r => ({\n      ...r,\n      type: \"reserve\",\n      dateObj: new Date(r.date),\n      km: parseFloat(r.km)\n    }));\n\n    const taggedPetrols = petrols.map(p => ({\n      ...p,\n      type: \"petrol\",\n      dateObj: new Date(p.date),\n      litres: parseFloat(p.litres),\n      km: parseFloat(p.km)\n    }));\n\n    const allLogs = [...taggedReserves, ...taggedPetrols].sort(\n      (a, b) => a.dateObj - b.dateObj\n    );\n\n    let latest = null;\n\n    for (let i = 0; i < allLogs.length - 2; i++) {\n      const first = allLogs[i];\n      const second = allLogs[i + 1];\n      const third = allLogs[i + 2];\n\n      if (\n        first.type === \"reserve\" &&\n        second.type === \"petrol\" &&\n        third.type === \"reserve\"\n      ) {\n        const distance = third.km - first.km;\n        const mileage =\n          second.litres && distance > 0\n            ? (distance / second.litres).toFixed(2)\n            : \"N/A\";\n\n        latest = {\n          beforeReserveKm: first.km,\n          petrolLitres: second.litres,\n          afterReserveKm: third.km,\n          mileage,\n        };\n      }\n    }\n\n    setLog(latest);\n  }, []);\n\n  return (\n    <div style={{ padding: 20 }}>\n      <h3>ðŸ“Š Mileage Report</h3>\n      {log ? (\n        <table border=\"1\" cellPadding=\"6\" style={{ borderCollapse: \"collapse\" }}>\n          <thead>\n            <tr>\n              <th>S.No</th>\n              <th>Before Petrol Reserved KM</th>\n              <th>Petrol Poured (Litres)</th>\n              <th>After Petrol Reserved KM</th>\n              <th>Mileage (km/l)</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr>\n              <td>1</td>\n              <td>{log.beforeReserveKm}</td>\n              <td>{log.petrolLitres}</td>\n              <td>{log.afterReserveKm}</td>\n              <td>{log.mileage}</td>\n            </tr>\n          </tbody>\n        </table>\n      ) : (\n        <p>No valid Reserve â†’ Petrol â†’ Reserve sequence found.</p>\n      )}\n    </div>\n  );\n};\n\nexport default Mileage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}